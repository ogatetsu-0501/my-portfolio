# LoveCard – ラブライブ！カードゲーム シミュレーター

1人用のラブライブ！カードゲーム検証用シミュレーターです。  
紙カードを用いたデッキ検証の手間を削減し、**構築の回り方や確率を短時間で検証すること**を目的に開発しました。

---

## 概要

本ツールは、友人が始めた「ラブライブ！カードゲーム」のデッキ検証のために作成した **ローカル実行型シミュレーター** です。

通常は以下のような準備が必要になります。

- プロキシカードの印刷・裁断
- シャッフルや山札管理
- ドロー、コスト支払い、サーチなどの反復操作

これらの作業を可能な限り自動化し、  
**カード固有効果のみを人が判断する設計** とすることで、  
紙で回すよりも高速かつ安定した検証を可能にしています。

また、ブレード枚数や色配分に対する **ライブ成功確率を数値で確認できる統計機能** を備え、  
単なる再現ではなく「紙以上の付加価値」を持たせています。

---

## 想定ユーザー

- ラブライブ！カードゲームを遊んでいるプレイヤー
- デッキ構築や確率検証に興味があるが、プログラミング知識はない人
- 紙での検証が面倒・時間がかかると感じている人

---

## 主な機能

- 山札・手札・ステージ・控室などの状態を管理したゲーム進行
- ドロー、コスト支払い、サーチなどの定型処理の自動化
- ブレード枚数・ハート要求数を指定したライブ成功確率計算
- カード画像・カードデータの自動更新（再インストール不要）
- Windows向け exe 配布（ワンクリック起動）

---

## 使用技術

### 言語 / ランタイム
- Python 3

### ライブラリ
- **Pygame**  
  ゲーム画面描画、マウス操作、カード操作
- **Tkinter**  
  統計・確率計算用ウィンドウ（別スレッド動作）
- **PyInstaller**  
  Windows向け exe ビルド
- **PyCryptodome**  
  カードデータの AES 復号処理

### データ・外部連携
- JSON（カード・デッキ・設定）
- urllib（カード画像の自動ダウンロード）
- GitHub API（暗号化カードデータの更新確認）

---

## 実装上の工夫

### 状態管理の一元化
- `GameState` データクラスに、山札・手札・ステージ・控室など全状態を集約
- どの処理からでも現在状態を安全に参照・更新可能

### 表示・入力・ルールの分離
- レイアウト計算、描画、入力処理をモジュール分割
- 画面座標はすべて比率計算とし、解像度差による崩れを防止

### カード画像・データ更新の自動化
- 不足画像は外部サーバーから自動取得
- カードデータは暗号化JSONをGitHubから取得し復号
- ユーザーが手動で更新作業を行う必要なし

### 確率計算の高速化
- DP（動的計画法）を用いてライブ成功確率を計算
- 状態数を削減し、全探索による計算爆発を回避

---

## 技術的な課題と対応

### Pygame と Tkinter の共存
- 同一スレッド実行によるフリーズを確認
- `threading` により統計ウィンドウを別スレッド化して解決

### exe 自己更新の制約
- 実行中 exe を上書きできない問題に対応するため、
  外部アップデータ `update.exe` を別プロセスで起動する構成を採用
- 更新後は自動再起動

### ウイルス誤検知への対応
- 自己更新挙動が一部 AV に誤検知されることを確認
- 原因を切り分け、より安全な更新設計への知見を獲得

---

## 成果・効果

- 紙カードを使わずにデッキ検証が可能
- デッキ検証速度が大幅に向上したらしい
- 新カード追加時も再ビルド不要で即対応

---

## 注意事項

- 本ツールは非公式のファンメイドツールです
- ゲームおよびカード画像の権利は各権利者に帰属します
- 個人利用・検証用途を想定しています
