# ジョブカン会計 自動移管ツール

## ① プロジェクト概要
職場で会計ソフトを GLOVIA から ジョブカン会計 に移行する際、引き継ぎミスにより **3か月分の仕訳データを手入力で再登録する必要** が発生しました。
経理担当者の負担軽減と誤入力防止を目的に、**GLOVIA の CSV 出力を読み込み、ジョブカン会計の仕訳画面に自動入力するツール**を、わずか3日で開発しました。

想定利用者は経理担当者および工場責任者クラス。
非エンジニアでも使えるよう、ダブルクリックだけで動作する自動化ツールとして設計しています。

## ② 使用技術
- **言語**：Python 3
- **主要ライブラリ**：
  - Selenium（ブラウザ自動操作）
  - webdriver-manager（ChromeDriverの自動管理）
  - Tkinter（GUI入力・進捗バー）
  - csv / re / unicodedata（データ整形）
  - ctypes（Windowsウィンドウ制御）
- **対象環境**：Windows + Google Chrome
- **配布形態**：PyInstaller により単一の `.exe` にビルド（`ジョブカン自動移管ツール.exe`）

## ③ 工夫した点・実装の特徴
### ● CSV構成の安全な統合
- GLOVIA出力の複数CSV（例：`4glPrintPdf.csv`, `8glPrintPdf.csv`）を自動で統合。
- 読み込み時に `utf-8` / `cp932` / `shift_jis` を順に試行し、自動でエンコード補正。
- 伝票のユニークキー（B列＋I列）で重複チェックし、再実行時の重複登録を防止。

### ● GLOVIA列 → ジョブカン項目の明示マッピング
- 各列を Excel列記号で定義（例：`CX=借方科目コード`, `HU=貸方科目コード`）。
- 列変更時も定数だけ修正すれば追従可能な設計。

### ● 金額・税区分の正規化
- 全角数字・カンマ・円記号を除去し、半角整数に統一。
- 特殊な税区分コード（例：`5D`, `5T`）をジョブカン仕様に自動変換。

### ● グルーピングと整合性チェック
- H列で同一伝票をグループ化し、伝票単位で登録。
- 登録前に「差額合計 = 0」であるか検証し、誤差がある場合はエラーとしてスキップ。

### ● UI面の工夫
- Tkinterで進捗バーを表示し、残り時間を概算。
- Chromeウィンドウを最背面に送って誤操作を防止。
- 全処理結果・エラー行を `result.csv` / `error_log.csv` に出力。

### ● 安全性と運用性
- CSV構造・データ型を担当者と綿密に確認し、破壊的な登録を防止。
- CSVインポート機能はあえて使用せず、人間操作に近いSelenium入力で安全性を確保。

## ④ 技術的な学び・課題解決
### ● ドメイン理解と安全性
業務データの構造を正確に把握し、必要な列のみを抽出。
担当者と実データを突き合わせ、**正しい列マッピング**を導き出しました。
「まず仕様を正しく理解すること」がツール安全性の基盤であると実感。

### ● CSVインポートを使わない設計判断
ジョブカン側にインポート機能は存在したが、
- 破壊リスク・仕様不明・検証不可のため
- 画面入力を自動化する方が安全かつ説明責任を果たしやすい

という理由から **UI自動操作での移管を選択**。
リスクを「完全自動化」ではなく「安全自動化」で解決しました。

### ● 日本語システム特有のデータ揺れ対策
Shift-JIS / 全角数字 / 税コード末尾Zなど、会計システム特有のゆらぎを吸収。
文字正規化とデータクレンジング処理を組み込み、**実務レベルで堅牢な変換**を実現。

### ● 組織的な学び
開発前に工場長への報告と承認を行い、リスク説明も実施。
しかし実行後、本部長から「こうしたツールは怖い」と指導を受けました。
**すでに報告・承認を経ていたにも関わらず、上層部が自動化技術を十分理解していなかった**ことが背景にあります。

この経験から、
- 技術的正しさだけでなく、**非技術層に理解される説明と合意形成の重要性**
- 組織全体での自動化リテラシー向上の必要性

を強く認識しました。

この価値観の違いをきっかけに、**より技術理解のある環境で自動化に取り組みたい**と考えるようになり、転職を決意しました。

## ⑤ 成果・効果
- 3か月分の仕訳を誤登録なしで移行。
- 経理担当者の入力時間を **実質0に削減**。
- エラー検知・重複防止・整合性チェックを備え、安全に完了。
- 「3日で開発→即実戦投入→成功」というスピード感を評価される。
- 同時に、組織のIT理解度の課題を浮き彫りにし、改善の必要性を痛感。

---

© 2025 自動化技術ポートフォリオ / Jobkan Transfer Tool
